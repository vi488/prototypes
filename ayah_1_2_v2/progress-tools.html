<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Progress Tools - ayah</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <style>
        /* Ayah Educational AI Platform - Comprehensive Design System */
        :root {
            /* Brand Color Hierarchy - Wisdom Purple System */
            --ayah-primary: #6048EB;           /* Main brand - AI responses, primary actions */
            --ayah-primary-hover: #4F3BC9;     /* Interactive states - button hover, link hover */
            --ayah-primary-light: #F4F1FF;     /* AI message backgrounds, subtle highlights */
            --ayah-primary-lighter: #F4FDFF;   /* Page backgrounds, card backgrounds */
            --ayah-primary-dark: #3A2A9E;      /* High emphasis text, important icons */

            /* Data Visualization Colors - Educational Analytics */
            --chart-color-1: #6048EB;          /* Primary brand variation */
            --chart-color-2: #4B7EF5;          /* Complementary blue */
            --chart-color-3: #8B5EF0;          /* Analogous purple */
            --chart-color-4: #9B48EB;          /* Triadic variation */
            --chart-color-5: #7B5EF0;          /* Split-complementary */
            --chart-color-6: #A855F7;          /* Neutral accent */
            --chart-color-7: #9333EA;          /* Additional for complex datasets */
            --chart-color-8: #B18AFA;          /* Extended palette */

            /* Progress Visualization Colors */
            --progress-mastery-none: #F3F4F6;         /* No progress - light gray */
            --progress-mastery-intro: #FEF3C7;        /* Introduction - light yellow */
            --progress-mastery-practice: #DBEAFE;     /* Practice - light blue */
            --progress-mastery-proficient: #D1FAE5;   /* Proficient - light green */
            --progress-mastery-advanced: #F4F1FF;     /* Advanced - light purple */

            /* Time-Based Progress Colors */
            --progress-today: #6048EB;                /* Today's activity */
            --progress-week: #8B5CF6;                 /* This week */
            --progress-month: #A855F7;                /* This month */
            --progress-older: #C4B5FD;                /* Older activity */

            /* Performance Trend Colors */
            --trend-improving: #22C55E;            /* Upward trend - green */
            --trend-stable: #F59E0B;               /* Stable trend - orange */
            --trend-declining: #EF4444;            /* Downward trend - red */
            --trend-neutral: #6B7280;              /* No significant change */

            /* Interactive Chart Elements */
            --chart-grid: #E5E7EB;                 /* Grid lines */
            --chart-axis: #6B7280;                 /* Axis labels */
            --chart-tooltip-bg: #1F2937;           /* Tooltip background */
            --chart-tooltip-text: #F9FAFB;         /* Tooltip text */
            --chart-hover: rgba(96, 72, 235, 0.1); /* Hover overlay */

            /* Educational Interaction Colors - Learning Feedback System */
            --ayah-correct: #22C55E;           /* Bright, encouraging green */
            --ayah-correct-bg: #DCFCE7;        /* Light green background */
            --ayah-correct-border: #16A34A;    /* Darker green border */
            --ayah-learning: #F59E0B;          /* Warm, non-threatening orange */
            --ayah-learning-bg: #FEF3C7;       /* Light orange background */
            --ayah-learning-border: #D97706;   /* Darker orange border */
            --ayah-hint: #3B82F6;              /* Friendly, helpful blue */
            --ayah-hint-bg: #DBEAFE;           /* Light blue background */
            --ayah-hint-border: #2563EB;       /* Darker blue border */

            /* Semantic Color System - Universal Meanings */
            --semantic-success: #10B981;       /* Emerald 500 */
            --semantic-success-light: #D1FAE5; /* Emerald 100 */
            --semantic-success-dark: #047857;  /* Emerald 700 */
            --semantic-error: #EF4444;         /* Red 500 */
            --semantic-error-light: #FEE2E2;   /* Red 100 */
            --semantic-error-dark: #DC2626;    /* Red 600 */
            --semantic-info: #3B82F6;          /* Blue 500 */
            --semantic-info-light: #DBEAFE;    /* Blue 100 */
            --semantic-info-dark: #1D4ED8;     /* Blue 700 */
            --semantic-warning: #F59E0B;       /* Amber 500 */
            --semantic-warning-light: #FEF3C7; /* Amber 100 */
            --semantic-warning-dark: #D97706;  /* Amber 600 */

            /* Neutral Color System - 9-11 variations */
            --neutral-50: #FAFAFA;   /* Lightest background */
            --neutral-100: #F5F5F5;  /* Light background */
            --neutral-200: #E5E5E5;  /* Border light */
            --neutral-300: #D4D4D4;  /* Border medium */
            --neutral-400: #A3A3A3;  /* Placeholder text */
            --neutral-500: #737373;  /* Secondary text */
            --neutral-600: #525252;  /* Primary text light */
            --neutral-700: #404040;  /* Primary text */
            --neutral-800: #262626;  /* Headings */
            --neutral-900: #171717;  /* High emphasis text */

            /* Spacing System - 8px Base Grid */
            --space-1: 4px;   /* 0.25rem - Micro spacing */
            --space-2: 8px;   /* 0.5rem - Base unit */
            --space-3: 12px;  /* 0.75rem - Small spacing */
            --space-4: 16px;  /* 1rem - Medium spacing */
            --space-5: 20px;  /* 1.25rem - Large spacing */
            --space-6: 24px;  /* 1.5rem - XL spacing */
            --space-8: 32px;  /* 2rem - XXL spacing */
            --space-10: 40px; /* 2.5rem - Section spacing */
            --space-12: 48px; /* 3rem - Page spacing */
            --space-16: 64px; /* 4rem - Major section spacing */
            --space-20: 80px; /* 5rem - Page margins */

            /* Typography Scale - Modular Scale: 1.250 (Major Third) */
            --text-display-large: 57px;   /* Hero headlines */
            --text-display-medium: 45px;  /* Page titles */
            --text-display-small: 36px;   /* Section headers */
            --text-headline-large: 32px;  /* Card titles */
            --text-headline-medium: 28px; /* Subsection headers */
            --text-headline-small: 24px;  /* Component titles */
            --text-title-large: 22px;     /* List headers */
            --text-title-medium: 16px;    /* Button text, labels */
            --text-title-small: 14px;     /* Captions, metadata */
            --text-body-large: 16px;      /* Primary body text */
            --text-body-medium: 14px;     /* Secondary body text */
            --text-body-small: 12px;      /* Fine print, disclaimers */

            /* Component Design Standards */
            --border-radius-small: 8px;   /* Modern feel */
            --border-radius-medium: 12px; /* Cards and containers */
            --border-radius-large: 16px;  /* Modals and major components */
            --border-radius-pill: 24px;   /* Pill-shaped CTAs */

            /* Shadow System */
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.1);     /* Subtle elevation */
            --shadow-md: 0 4px 12px rgba(0,0,0,0.15);   /* Medium elevation */
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.2);    /* High elevation */
            --shadow-xl: 0 12px 32px rgba(0,0,0,0.25);  /* Maximum elevation */
        }

        /* Educational AI Platform Typography */
        body {
            font-family: "SF Pro Display", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--neutral-50);
            color: var(--neutral-700);
            line-height: 1.5;
        }

        /* CSS Custom Properties for Dynamic Theming */
        .bg-ayah-primary { background-color: var(--ayah-primary); }
        .text-ayah-primary { color: var(--ayah-primary); }
        .border-ayah-primary { border-color: var(--ayah-primary); }
        .hover\:bg-ayah-primary:hover { background-color: var(--ayah-primary-hover); }
        .bg-ayah-primary-light { background-color: var(--ayah-primary-light); }
        .text-ayah-primary-dark { color: var(--ayah-primary-dark); }

        /* Data Visualization Color Classes */
        .chart-color-1 { color: var(--chart-color-1); }
        .chart-color-2 { color: var(--chart-color-2); }
        .chart-color-3 { color: var(--chart-color-3); }
        .chart-color-4 { color: var(--chart-color-4); }
        .chart-color-5 { color: var(--chart-color-5); }
        .chart-color-6 { color: var(--chart-color-6); }
        .chart-color-7 { color: var(--chart-color-7); }
        .chart-color-8 { color: var(--chart-color-8); }

        .bg-chart-color-1 { background-color: var(--chart-color-1); }
        .bg-chart-color-2 { background-color: var(--chart-color-2); }
        .bg-chart-color-3 { background-color: var(--chart-color-3); }
        .bg-chart-color-4 { background-color: var(--chart-color-4); }
        .bg-chart-color-5 { background-color: var(--chart-color-5); }
        .bg-chart-color-6 { background-color: var(--chart-color-6); }
        .bg-chart-color-7 { background-color: var(--chart-color-7); }
        .bg-chart-color-8 { background-color: var(--chart-color-8); }

        /* Progress Mastery Level Classes */
        .mastery-none { background-color: var(--progress-mastery-none); }
        .mastery-intro { background-color: var(--progress-mastery-intro); }
        .mastery-practice { background-color: var(--progress-mastery-practice); }
        .mastery-proficient { background-color: var(--progress-mastery-proficient); }
        .mastery-advanced { background-color: var(--progress-mastery-advanced); }

        /* Time-Based Progress Classes */
        .progress-today { color: var(--progress-today); }
        .progress-week { color: var(--progress-week); }
        .progress-month { color: var(--progress-month); }
        .progress-older { color: var(--progress-older); }

        .bg-progress-today { background-color: var(--progress-today); }
        .bg-progress-week { background-color: var(--progress-week); }
        .bg-progress-month { background-color: var(--progress-month); }
        .bg-progress-older { background-color: var(--progress-older); }

        /* Performance Trend Classes */
        .trend-improving { color: var(--trend-improving); }
        .trend-stable { color: var(--trend-stable); }
        .trend-declining { color: var(--trend-declining); }
        .trend-neutral { color: var(--trend-neutral); }

        .bg-trend-improving { background-color: var(--trend-improving); }
        .bg-trend-stable { background-color: var(--trend-stable); }
        .bg-trend-declining { background-color: var(--trend-declining); }
        .bg-trend-neutral { background-color: var(--trend-neutral); }

        /* Component Design Standards */
        .progress-card {
            border-radius: var(--border-radius-medium);
            box-shadow: var(--shadow-sm);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            background-color: white;
            overflow: hidden;
            border: 1px solid var(--neutral-200);
        }

        .progress-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* Chart Container Styling */
        .chart-container {
            background-color: white;
            border-radius: var(--border-radius-medium);
            box-shadow: var(--shadow-sm);
            padding: var(--space-6);
            border: 1px solid var(--neutral-200);
        }

        /* Button Design Standards */
        .btn-primary {
            background-color: var(--ayah-primary);
            color: white;
            padding: var(--space-3) var(--space-4);
            border-radius: var(--border-radius-small);
            font-size: var(--text-title-medium);
            font-weight: 500;
            transition: background-color 0.2s ease, transform 0.1s ease;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-height: 48px; /* Touch target minimum */
        }

        .btn-primary:hover {
            background-color: var(--ayah-primary-hover);
            transform: translateY(-1px);
        }

        .btn-primary:active {
            transform: scale(0.98);
        }

        /* Typography Classes */
        .text-display-large { font-size: var(--text-display-large); line-height: 1.1; }
        .text-display-medium { font-size: var(--text-display-medium); line-height: 1.15; }
        .text-headline-large { font-size: var(--text-headline-large); line-height: 1.25; }
        .text-headline-medium { font-size: var(--text-headline-medium); line-height: 1.3; }
        .text-title-large { font-size: var(--text-title-large); line-height: 1.3; }
        .text-body-large { font-size: var(--text-body-large); line-height: 1.5; }
        .text-body-medium { font-size: var(--text-body-medium); line-height: 1.4; }

        /* Interactive Chart Styles - Educational Design */
        .chart-type-btn, .period-btn {
            color: var(--neutral-500);
            background-color: transparent;
            border: 1px solid var(--neutral-200);
            border-radius: var(--border-radius-small);
            padding: var(--space-2) var(--space-3);
            font-size: var(--text-title-small);
            font-weight: 500;
            transition: all 0.2s ease;
            cursor: pointer;
            min-height: 48px; /* Touch target minimum */
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .chart-type-btn.active, .period-btn.active {
            background-color: var(--ayah-primary);
            color: white;
            border-color: var(--ayah-primary);
            box-shadow: var(--shadow-sm);
        }

        .chart-type-btn:hover, .period-btn:hover {
            color: var(--ayah-primary);
            border-color: var(--ayah-primary);
            background-color: var(--ayah-primary-light);
        }

        /* Chart Tooltip Styling */
        .chart-tooltip {
            background-color: var(--chart-tooltip-bg);
            color: var(--chart-tooltip-text);
            border-radius: var(--border-radius-small);
            padding: var(--space-2) var(--space-3);
            font-size: var(--text-body-small);
            box-shadow: var(--shadow-md);
        }

        /* Chart Legend Styling */
        .chart-legend {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-4);
            margin-top: var(--space-4);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-size: var(--text-body-small);
            color: var(--neutral-600);
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }

        /* Progress Indicator Styling */
        .progress-indicator {
            background-color: var(--neutral-200);
            border-radius: var(--border-radius-pill);
            overflow: hidden;
            height: var(--space-2);
        }

        .progress-fill {
            height: 100%;
            transition: width 0.3s ease;
            border-radius: var(--border-radius-pill);
        }

        /* Chart loading animation */
        @keyframes chartFadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chart-fade-in {
            animation: chartFadeIn 0.5s ease-out;
        }

        /* Responsive Design - Mobile-First Approach */
        @media (max-width: 767px) {
            :root {
                /* Mobile typography adjustments */
                --text-display-large: 36px;
                --text-display-medium: 32px;
                --text-headline-large: 28px;
                --text-headline-medium: 24px;
            }

            .chart-container {
                padding: var(--space-4);
            }

            .chart-type-btn, .period-btn {
                font-size: var(--text-body-small);
                padding: var(--space-2);
            }
        }

        @media (min-width: 768px) and (max-width: 1023px) {
            /* Tablet-specific adjustments */
            .chart-container {
                padding: var(--space-5);
            }
        }

        @media (min-width: 1024px) {
            /* Desktop-specific adjustments */
            .chart-container {
                padding: var(--space-6);
            }
        }

        /* Dark Mode Support */
        @media (prefers-color-scheme: dark) {
            :root {
                /* Adjusted brand colors for dark mode */
                --ayah-primary: #8B5CF6;              /* Lighter purple for dark backgrounds */
                --ayah-primary-light: #1E1B4B;        /* Dark purple background */
                --ayah-primary-lighter: #0F0F23;      /* Very dark background */

                /* Chart colors for dark mode */
                --chart-grid: #374151;
                --chart-axis: #9CA3AF;
                --chart-tooltip-bg: #F9FAFB;
                --chart-tooltip-text: #1F2937;

                /* Neutral colors for dark mode */
                --neutral-50: #0F0F23;
                --neutral-100: #1E1B4B;
                --neutral-200: #262626;
                --neutral-300: #404040;
                --neutral-400: #525252;
                --neutral-500: #737373;
                --neutral-600: #A3A3A3;
                --neutral-700: #D4D4D4;
                --neutral-800: #E5E5E5;
                --neutral-900: #F5F5F5;
            }

            .progress-card, .chart-container {
                background-color: var(--neutral-100);
                color: var(--neutral-800);
                border-color: var(--neutral-300);
            }
        }

        /* Accessibility Enhancements */
        .focus-visible {
            outline: 2px solid var(--ayah-primary);
            outline-offset: 2px;
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            :root {
                --ayah-primary: #4F3BC9;
                --chart-color-1: #4F3BC9;
                --chart-color-2: #1D4ED8;
                --chart-color-3: #7C3AED;
                --chart-color-4: #BE185D;
            }
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            .progress-card,
            .btn-primary,
            .chart-type-btn,
            .period-btn {
                transition: none;
            }

            .progress-card:hover {
                transform: none;
            }

            .btn-primary:hover {
                transform: none;
            }

            .chart-fade-in {
                animation: none;
            }
        }
            }

            /* Mobile-optimized layout */
            .mobile-stack {
                flex-direction: column !important;
                gap: 1rem !important;
            }

            .mobile-full-width {
                width: 100% !important;
            }

            /* Larger text for mobile readability */
            .mobile-text-lg {
                font-size: 1.125rem !important;
            }

            .mobile-text-xl {
                font-size: 1.25rem !important;
            }

            /* Touch-friendly spacing */
            .mobile-touch-spacing {
                padding: 1rem !important;
            }

            /* Simplified mobile charts */
            .mobile-chart-container {
                height: 250px !important;
            }

            /* Mobile card stacking */
            .mobile-card-stack > * {
                margin-bottom: 1rem;
            }

            /* Mobile button groups */
            .mobile-btn-group {
                display: flex;
                flex-direction: column;
                gap: 0.5rem;
            }

            .mobile-btn-group .chart-type-btn,
            .mobile-btn-group .period-btn {
                width: 100%;
                justify-content: center;
            }
        }

        /* Tablet optimization */
        @media (min-width: 641px) and (max-width: 1024px) {
            .tablet-grid-2 {
                grid-template-columns: repeat(2, 1fr) !important;
            }

            .tablet-text-base {
                font-size: 1rem !important;
            }
        }

        /* Touch interaction feedback */
        .touch-feedback {
            transition: all 0.15s ease;
        }

        .touch-feedback:active {
            transform: scale(0.98);
            background-color: rgba(96, 72, 235, 0.1);
        }

        /* Background illustration blur effect - now applied directly to images */

        /* Loading states optimized for mobile */
        .mobile-loading {
            min-height: 200px;
        }

        /* Swipe indicators for mobile navigation */
        .swipe-indicator {
            display: none;
        }

        @media (max-width: 640px) {
            .swipe-indicator {
                display: block;
                text-align: center;
                color: #9CA3AF;
                font-size: 0.75rem;
                margin-top: 0.5rem;
            }
        }
    </style>
</head>
<body class="bg-white font-sans">
    <div class="px-6 py-8">
        <!-- Header - Mobile Optimized -->
        <div class="mb-8">
            <div class="flex flex-col sm:flex-row sm:items-center justify-between">
                <div class="mb-4 sm:mb-0">
                    <h1 class="text-2xl font-semibold text-gray-900 mb-2">Learning Progress</h1>
                    <p class="text-gray-600 text-sm">Track your academic achievements and goal progress</p>
                </div>
            </div>
        </div>

        <!-- Learning Statistics Overview - Redesigned for Better UX -->
        <div class="bg-white rounded-lg border border-gray-200 p-4 sm:p-6 mb-8">
            <!-- Header with Context -->
            <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-2">
                <div class="mb-2 sm:mb-0">
                    <h2 class="text-lg font-semibold text-gray-900">This Week's Progress</h2>
                    <p class="text-gray-600 text-sm">Sept 16-22, 2024 • 7 days tracked</p>
                </div>
                <div class="flex items-center space-x-2">
                    <button class="p-2 rounded-lg hover:bg-gray-100 text-gray-600 transition-colors duration-200">
                        <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                    </button>
                </div>
            </div>

            <!-- All Metrics in Single Row - Ordered by Importance -->
            <div class="grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-5 gap-3">
                <!-- 1. Study Time - Most Important -->
                <div class="bg-ayah-bg-light rounded-lg p-6 border border-ayah-bg-medium min-h-[160px] relative overflow-hidden">
                    <!-- Background Illustration - Centered -->
                    <div class="absolute bottom-4 right-2">
                        <img src="undraw-relaxed-reading-wfkr.svg" alt="Study Time" class="w-32 h-32">
                    </div>
                    <div class="relative z-10">
                        <div class="flex items-center space-x-2 mb-3">
                            <i data-lucide="clock" class="w-5 h-5 text-ayah-primary"></i>
                            <span class="text-base font-medium text-ayah-primary">Study Time</span>
                        </div>
                        <div class="text-4xl font-bold text-ayah-primary">3h 45m</div>
                        <div class="w-full bg-ayah-bg-medium rounded-full h-2 mt-12">
                            <div class="bg-ayah-primary h-2 rounded-full" style="width: 75%"></div>
                        </div>
                    </div>
                </div>

                <!-- 2. Problems Solved - High Engagement -->
                <div class="bg-ayah-bg-light rounded-lg p-6 border border-ayah-bg-medium min-h-[160px] relative overflow-hidden">
                    <!-- Background Illustration - Centered -->
                    <div class="absolute bottom-4 right-2" style="padding-bottom: 25px;">
                        <img src="undraw-problem-solving-8lg7.svg" alt="Problems Solved" class="w-32 h-32">
                    </div>
                    <div class="relative z-10">
                        <div class="flex items-center space-x-2 mb-3">
                            <i data-lucide="brain" class="w-5 h-5 text-ayah-primary"></i>
                            <span class="text-base font-medium text-ayah-primary">Problems</span>
                        </div>
                        <div class="text-4xl font-bold text-ayah-primary">28</div>
                        <div class="w-full bg-ayah-bg-medium rounded-full h-2 mt-12">
                            <div class="bg-ayah-primary h-2 rounded-full" style="width: 93%"></div>
                        </div>
                    </div>
                </div>

                <!-- 3. Learning Streak - Motivational -->
                <div class="bg-ayah-bg-light rounded-lg p-6 border border-ayah-bg-medium min-h-[160px] relative overflow-hidden">
                    <!-- Background Illustration - Centered -->
                    <div class="absolute bottom-4 right-2" style="padding-bottom: 25px;">
                        <img src="undraw-certification-i2m0.svg" alt="Learning Streak" class="w-32 h-32">
                    </div>
                    <div class="relative z-10">
                        <div class="flex items-center space-x-2 mb-3">
                            <i data-lucide="zap" class="w-5 h-5 text-ayah-primary"></i>
                            <span class="text-base font-medium text-ayah-primary">Streak</span>
                        </div>
                        <div class="text-4xl font-bold text-ayah-primary">5 days</div>
                        <div class="w-full bg-ayah-bg-medium rounded-full h-2 mt-12">
                            <div class="bg-ayah-primary h-2 rounded-full" style="width: 83%"></div>
                        </div>
                    </div>
                </div>

                <!-- 4. Topics Learned - Progress Indicator -->
                <div class="bg-ayah-bg-light rounded-lg p-6 border border-ayah-bg-medium min-h-[160px] relative overflow-hidden">
                    <!-- Background Illustration - Centered -->
                    <div class="absolute bottom-4 right-2" style="padding-bottom: 25px;">
                        <img src="undraw-knowledge-0ty5.svg" alt="Topics Learned" class="w-32 h-32">
                    </div>
                    <div class="relative z-10">
                        <div class="flex items-center space-x-2 mb-3">
                            <i data-lucide="book-open" class="w-5 h-5 text-ayah-primary"></i>
                            <span class="text-base font-medium text-ayah-primary">Topics</span>
                        </div>
                        <div class="text-4xl font-bold text-ayah-primary">7</div>
                        <div class="w-full bg-ayah-bg-medium rounded-full h-2 mt-12">
                            <div class="bg-ayah-primary h-2 rounded-full" style="width: 70%"></div>
                        </div>
                    </div>
                </div>

                <!-- 5. Sessions Completed - Activity Metric -->
                <div class="bg-ayah-bg-light rounded-lg p-6 border border-ayah-bg-medium min-h-[160px] relative overflow-hidden">
                    <!-- Background Illustration - Centered -->
                    <div class="absolute bottom-4 right-2">
                        <img src="undraw-online-learning-tgmv.svg" alt="Sessions Completed" class="w-32 h-32">
                    </div>
                    <div class="relative z-10">
                        <div class="flex items-center space-x-2 mb-3">
                            <i data-lucide="play-circle" class="w-5 h-5 text-ayah-primary"></i>
                            <span class="text-base font-medium text-ayah-primary">Sessions</span>
                        </div>
                        <div class="text-4xl font-bold text-ayah-primary">12</div>
                        <div class="w-full bg-ayah-bg-medium rounded-full h-2 mt-12">
                            <div class="bg-ayah-primary h-2 rounded-full" style="width: 80%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Learning Progress Charts - Mobile Optimized -->
        <div class="bg-white rounded-xl border border-gray-200 p-4 sm:p-6 mb-6 sm:mb-8">
            <div class="flex flex-col space-y-4 mb-6">
                <div class="flex flex-col sm:flex-row sm:items-center justify-between">
                    <div class="mb-3 sm:mb-0">
                        <h2 class="text-lg sm:text-xl font-semibold text-gray-800">Learning Progress Charts</h2>
                        <p class="text-sm text-gray-600 mt-1">See how your learning is going over time</p>
                    </div>
                    <!-- Mobile: Show chart info -->
                    <div class="sm:hidden text-right">
                        <div class="text-xs text-gray-500">Tap chart for details</div>
                        <div class="text-xs text-gray-500">Swipe to navigate</div>
                    </div>
                </div>

                <!-- Mobile-optimized controls -->
                <div class="space-y-3 sm:space-y-0 sm:flex sm:space-x-3">
                    <!-- Chart Type Selector - Mobile Stack -->
                    <div class="mobile-btn-group sm:flex bg-gray-100 rounded-lg p-1">
                        <button id="lineChartBtn" class="chart-type-btn active px-3 py-2 rounded-md text-sm font-medium transition-colors touch-feedback">
                            <i data-lucide="trending-up" class="w-4 h-4 inline mr-2"></i>Line Chart
                        </button>
                        <button id="barChartBtn" class="chart-type-btn px-3 py-2 rounded-md text-sm font-medium transition-colors touch-feedback">
                            <i data-lucide="bar-chart-3" class="w-4 h-4 inline mr-2"></i>Bar Chart
                        </button>
                        <button id="areaChartBtn" class="chart-type-btn px-3 py-2 rounded-md text-sm font-medium transition-colors touch-feedback">
                            <i data-lucide="area-chart" class="w-4 h-4 inline mr-2"></i>Area Chart
                        </button>
                    </div>
                    <!-- Time Period Selector - Mobile Stack -->
                    <div class="mobile-btn-group sm:flex bg-gray-100 rounded-lg p-1">
                        <button id="period7" class="period-btn active px-4 py-2 rounded-md text-sm font-medium transition-colors touch-feedback" data-period="7">Last 7 Days</button>
                        <button id="period14" class="period-btn px-4 py-2 rounded-md text-sm font-medium transition-colors touch-feedback" data-period="14">Last 14 Days</button>
                        <button id="period30" class="period-btn px-4 py-2 rounded-md text-sm font-medium transition-colors touch-feedback" data-period="30">Last 30 Days</button>
                    </div>
                </div>
            </div>



            <!-- Loading State - Mobile Optimized -->
            <div id="chartLoading" class="h-64 sm:h-80 w-full flex items-center justify-center bg-gray-50 rounded-lg mobile-loading">
                <div class="text-center">
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-ayah-primary mx-auto mb-2"></div>
                    <p class="text-sm text-gray-600">Getting your progress ready...</p>
                    <p class="text-xs text-gray-500 mt-1">Almost there! ✨</p>
                </div>
            </div>

            <!-- Interactive Chart Container - Mobile Optimized -->
            <div id="chartContainer" class="h-64 sm:h-80 w-full relative mobile-chart-container" style="display: none;">
                <canvas id="progressChart" class="w-full h-full touch-action-manipulation"></canvas>
                <!-- Mobile chart overlay for touch interactions -->
                <div class="sm:hidden absolute top-2 right-2 bg-white bg-opacity-90 rounded-lg p-2 text-xs text-gray-600">
                    <div class="flex items-center space-x-1">
                        <i data-lucide="touch" class="w-3 h-3"></i>
                        <span>Tap for details</span>
                    </div>
                </div>
            </div>

            <!-- Mobile swipe indicator -->
            <div class="swipe-indicator">
                <i data-lucide="chevrons-left-right" class="w-4 h-4 inline mr-1"></i>
                Swipe chart to explore data points
            </div>

            <!-- Chart Performance Info -->
            <div class="flex items-center justify-between mt-4 text-xs text-gray-500">
                <div class="flex items-center space-x-4">
                    <span id="dataPoints">Data points: 7</span>
                    <span id="lastUpdated">Last updated: 2 min ago</span>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="w-2 h-2 bg-ayah-primary rounded-full"></div>
                    <span>Real-time updates</span>
                </div>
            </div>


        </div>

        <!-- Learning Goals Progress - Enhanced Design -->
        <div class="bg-white rounded-lg border border-gray-200 p-4 sm:p-6 mb-8">
            <!-- Header with Context -->
            <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-2">
                <div class="mb-2 sm:mb-0">
                    <h2 class="text-lg font-semibold text-gray-900">Goals Progress</h2>
                    <p class="text-gray-600 text-sm">Current learning goals performance • 3 active</p>
                </div>
                <div class="flex items-center space-x-2">
                    <button class="p-2 rounded-lg hover:bg-gray-100 text-gray-600 transition-colors duration-200">
                        <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                    </button>
                    <button class="text-ayah-primary hover:text-ayah-primary-hover text-sm font-medium">
                        View All Goals →
                    </button>
                </div>
            </div>

            <!-- All Metrics in Single Row - Ordered by Importance -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3">
                <!-- 1. Active Goals - Most Important -->
                <div class="bg-ayah-bg-light rounded-lg p-6 border border-ayah-bg-medium min-h-[160px] relative overflow-hidden">
                    <!-- Background Illustration - Centered -->
                    <div class="absolute bottom-4 right-2" style="padding-bottom: 25px;">
                        <img src="undraw-target-d6hf.svg" alt="Active Goals" class="w-32 h-32">
                    </div>
                    <div class="relative z-10">
                        <div class="flex items-center space-x-2 mb-3">
                            <i data-lucide="target" class="w-5 h-5 text-ayah-primary"></i>
                            <span class="text-base font-medium text-ayah-primary">Active</span>
                        </div>
                        <div class="text-4xl font-bold text-ayah-primary">3</div>
                        <div class="w-full bg-ayah-bg-medium rounded-full h-2 mt-12">
                            <div class="bg-ayah-primary h-2 rounded-full" style="width: 60%"></div>
                        </div>
                    </div>
                </div>

                <!-- 2. Completed Goals - Achievement -->
                <div class="bg-ayah-bg-light rounded-lg p-6 border border-ayah-bg-medium min-h-[160px] relative overflow-hidden">
                    <!-- Background Illustration - Centered -->
                    <div class="absolute bottom-4 right-2" style="padding-bottom: 25px;">
                        <img src="undraw-completed-0sqh.svg" alt="Completed Goals" class="w-32 h-32">
                    </div>
                    <div class="relative z-10">
                        <div class="flex items-center space-x-2 mb-3">
                            <i data-lucide="check-circle" class="w-5 h-5 text-ayah-primary"></i>
                            <span class="text-base font-medium text-ayah-primary">Completed</span>
                        </div>
                        <div class="text-4xl font-bold text-ayah-primary">2</div>
                        <div class="w-full bg-ayah-bg-medium rounded-full h-2 mt-12">
                            <div class="bg-ayah-primary h-2 rounded-full" style="width: 40%"></div>
                        </div>
                    </div>
                </div>

                <!-- 3. On Track Goals - Progress Indicator -->
                <div class="bg-ayah-bg-light rounded-lg p-6 border border-ayah-bg-medium min-h-[160px] relative overflow-hidden">
                    <!-- Background Illustration - Centered -->
                    <div class="absolute bottom-4 right-2" style="padding-bottom: 25px;">
                        <img src="undraw-progress-tracking-9m3o.svg" alt="On Track Goals" class="w-32 h-32">
                    </div>
                    <div class="relative z-10">
                        <div class="flex items-center space-x-2 mb-3">
                            <i data-lucide="trending-up" class="w-5 h-5 text-ayah-primary"></i>
                            <span class="text-base font-medium text-ayah-primary">On Track</span>
                        </div>
                        <div class="text-4xl font-bold text-ayah-primary">2</div>
                        <div class="w-full bg-ayah-bg-medium rounded-full h-2 mt-12">
                            <div class="bg-ayah-primary h-2 rounded-full" style="width: 67%"></div>
                        </div>
                    </div>
                </div>

                <!-- 4. Average Progress - Analytics -->
                <div class="bg-ayah-bg-light rounded-lg p-6 border border-ayah-bg-medium min-h-[160px] relative overflow-hidden">
                    <!-- Background Illustration - Centered -->
                    <div class="absolute bottom-4 right-2">
                        <img src="undraw-data-analysis-b7cp.svg" alt="Average Progress" class="w-32 h-32">
                    </div>
                    <div class="relative z-10">
                        <div class="flex items-center space-x-2 mb-3">
                            <i data-lucide="percent" class="w-5 h-5 text-ayah-primary"></i>
                            <span class="text-base font-medium text-ayah-primary">Avg Progress</span>
                        </div>
                        <div class="text-4xl font-bold text-ayah-primary">68%</div>
                        <div class="w-full bg-ayah-bg-medium rounded-full h-2 mt-12">
                            <div class="bg-ayah-primary h-2 rounded-full" style="width: 68%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Next Steps Recommendations - Enhanced Interactive Version -->
        <div class="bg-white rounded-xl border border-gray-200 p-6 mb-8">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-semibold text-gray-800">Next Steps</h2>
                <div class="text-sm text-gray-500">Click to take action</div>
            </div>
            <div class="space-y-4">
                <!-- Math Goal Continuation - Simplified -->
                <div class="flex items-center justify-between p-4 bg-ayah-bg-light rounded-lg border border-gray-200">
                    <div class="flex items-start space-x-3">
                        <div class="w-8 h-8 bg-ayah-primary rounded-full flex items-center justify-center flex-shrink-0">
                            <i data-lucide="brain" class="w-4 h-4 text-white"></i>
                        </div>
                        <div class="flex-1">
                            <p class="font-medium text-gray-900">Continue working on Math - you're almost there!</p>
                            <p class="text-sm text-gray-600 mb-2">12 of 20 problems completed (60%)</p>
                            <!-- Progress Bar -->
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-ayah-primary h-2 rounded-full" style="width: 60%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button class="px-4 py-2 bg-ayah-primary text-white text-sm font-medium rounded-lg cursor-pointer" onclick="startMathSession()">
                            Continue
                        </button>
                        <i data-lucide="arrow-right" class="w-4 h-4 text-ayah-primary"></i>
                    </div>
                </div>

                <!-- Science Streak Maintenance - Simplified -->
                <div class="flex items-center justify-between p-4 bg-ayah-bg-light rounded-lg border border-gray-200">
                    <div class="flex items-start space-x-3">
                        <div class="w-8 h-8 bg-ayah-primary rounded-full flex items-center justify-center flex-shrink-0">
                            <i data-lucide="clock" class="w-4 h-4 text-white"></i>
                        </div>
                        <div class="flex-1">
                            <p class="font-medium text-gray-900">Try a quick Science session to maintain your streak</p>
                            <p class="text-sm text-gray-600 mb-2">15 more minutes needed to reach your goal</p>
                            <!-- Time Progress Indicator -->
                            <div class="flex items-center space-x-2">
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-ayah-primary h-2 rounded-full" style="width: 75%"></div>
                                </div>
                                <span class="text-xs text-gray-500 whitespace-nowrap">45/60 min</span>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button class="px-4 py-2 bg-ayah-primary text-white text-sm font-medium rounded-lg cursor-pointer" onclick="startScienceSession()">
                            Start
                        </button>
                        <i data-lucide="arrow-right" class="w-4 h-4 text-ayah-primary"></i>
                    </div>
                </div>

                <!-- History Challenge - Simplified -->
                <div class="flex items-center justify-between p-4 bg-ayah-bg-light rounded-lg border border-gray-200">
                    <div class="flex items-start space-x-3">
                        <div class="w-8 h-8 bg-ayah-primary rounded-full flex items-center justify-center flex-shrink-0">
                            <i data-lucide="star" class="w-4 h-4 text-white"></i>
                        </div>
                        <div class="flex-1">
                            <p class="font-medium text-gray-900">Great progress on History - consider setting a new challenge</p>
                            <p class="text-sm text-gray-600 mb-2">2 of 5 topics completed</p>
                            <!-- Achievement Progress -->
                            <div class="flex items-center space-x-2">
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-ayah-primary h-2 rounded-full" style="width: 40%"></div>
                                </div>
                                <span class="text-xs text-gray-500 whitespace-nowrap">2/5 topics</span>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button class="px-4 py-2 bg-ayah-primary text-white text-sm font-medium rounded-lg cursor-pointer" onclick="createHistoryChallenge()">
                            Create
                        </button>
                        <i data-lucide="arrow-right" class="w-4 h-4 text-ayah-primary"></i>
                    </div>
                </div>
            </div>

            <!-- Quick Actions Footer -->
            <div class="mt-6 pt-4 border-t border-gray-200">
                <div class="flex items-center justify-between">
                    <div class="text-sm text-gray-600">
                        <i data-lucide="lightbulb" class="w-4 h-4 inline mr-1"></i>
                        Tip: Complete actions to unlock new achievements
                    </div>
                    <button onclick="viewAllGoals()" class="text-sm text-ayah-primary hover:text-ayah-primary-hover font-medium">
                        View All Goals →
                    </button>
                </div>
            </div>
        </div>



    </div>

    <script>
        lucide.createIcons();

        // Interactive Progress Charts Implementation
        class InteractiveProgressCharts {
            constructor() {
                this.chart = null;
                this.currentChartType = 'line';
                this.currentPeriod = 7;
                this.chartData = this.generateSampleData();

                this.init();
            }

            init() {
                this.setupEventListeners();
                this.simulateLoading();
            }

            setupEventListeners() {
                // Chart type buttons
                document.querySelectorAll('.chart-type-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.handleChartTypeChange(e.target);
                    });
                });

                // Period buttons
                document.querySelectorAll('.period-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.handlePeriodChange(e.target);
                    });
                });

                // Mobile touch optimization
                if ('ontouchstart' in window) {
                    this.setupTouchOptimization();
                }
            }

            setupTouchOptimization() {
                // Add touch-friendly interactions
                document.querySelectorAll('.chart-type-btn, .period-btn').forEach(btn => {
                    btn.style.minHeight = '44px';
                    btn.addEventListener('touchstart', function() {
                        this.style.backgroundColor = 'rgba(96, 72, 235, 0.1)';
                        this.style.transform = 'scale(0.98)';
                    });
                    btn.addEventListener('touchend', function() {
                        this.style.transform = 'scale(1)';
                        setTimeout(() => {
                            if (!this.classList.contains('active')) {
                                this.style.backgroundColor = 'transparent';
                            }
                        }, 150);
                    });
                });

                // Add swipe gesture support for mobile chart navigation
                this.setupSwipeGestures();

                // Add mobile-specific chart interactions
                this.setupMobileChartInteractions();
            }

            setupSwipeGestures() {
                const chartContainer = document.getElementById('chartContainer');
                let startX = 0;
                let startY = 0;
                let isSwipe = false;

                chartContainer.addEventListener('touchstart', (e) => {
                    startX = e.touches[0].clientX;
                    startY = e.touches[0].clientY;
                    isSwipe = false;
                });

                chartContainer.addEventListener('touchmove', (e) => {
                    if (!startX || !startY) return;

                    const currentX = e.touches[0].clientX;
                    const currentY = e.touches[0].clientY;
                    const diffX = Math.abs(currentX - startX);
                    const diffY = Math.abs(currentY - startY);

                    // Detect horizontal swipe
                    if (diffX > diffY && diffX > 50) {
                        isSwipe = true;
                        e.preventDefault();
                    }
                });

                chartContainer.addEventListener('touchend', (e) => {
                    if (!isSwipe || !startX) return;

                    const endX = e.changedTouches[0].clientX;
                    const diffX = startX - endX;

                    // Swipe left - next period
                    if (diffX > 50) {
                        this.cyclePeriod(1);
                    }
                    // Swipe right - previous period
                    else if (diffX < -50) {
                        this.cyclePeriod(-1);
                    }

                    startX = 0;
                    startY = 0;
                    isSwipe = false;
                });
            }

            setupMobileChartInteractions() {
                // Add haptic feedback for mobile devices
                if ('vibrate' in navigator) {
                    document.querySelectorAll('.chart-type-btn, .period-btn').forEach(btn => {
                        btn.addEventListener('click', () => {
                            navigator.vibrate(50); // Short vibration feedback
                        });
                    });
                }

                // Add double-tap to reset zoom on mobile
                const chartCanvas = document.getElementById('progressChart');
                let lastTap = 0;

                chartCanvas.addEventListener('touchend', (e) => {
                    const currentTime = new Date().getTime();
                    const tapLength = currentTime - lastTap;

                    if (tapLength < 500 && tapLength > 0) {
                        // Double tap detected - reset chart view
                        if (this.chart) {
                            this.chart.resetZoom();
                            if ('vibrate' in navigator) {
                                navigator.vibrate([50, 50, 50]); // Triple vibration for reset
                            }
                        }
                    }
                    lastTap = currentTime;
                });
            }

            cyclePeriod(direction) {
                const periods = [7, 14, 30];
                const currentIndex = periods.indexOf(this.currentPeriod);
                let newIndex = currentIndex + direction;

                // Wrap around
                if (newIndex < 0) newIndex = periods.length - 1;
                if (newIndex >= periods.length) newIndex = 0;

                const newPeriod = periods[newIndex];
                const periodBtn = document.querySelector(`[data-period="${newPeriod}"]`);

                if (periodBtn) {
                    this.handlePeriodChange(periodBtn);

                    // Visual feedback for swipe
                    periodBtn.style.transform = 'scale(1.05)';
                    setTimeout(() => {
                        periodBtn.style.transform = 'scale(1)';
                    }, 200);
                }
            }

            simulateLoading() {
                // Show loading state for 1.5 seconds to demonstrate loading UX
                setTimeout(() => {
                    document.getElementById('chartLoading').style.display = 'none';
                    document.getElementById('chartContainer').style.display = 'block';
                    document.getElementById('chartContainer').classList.add('chart-fade-in');
                    this.createChart();
                    this.updateLastUpdated();
                }, 1500);
            }

            generateSampleData() {
                const data = {
                    7: this.generateDataPoints(7),
                    14: this.generateDataPoints(14),
                    30: this.generateDataPoints(30)
                };
                return data;
            }

            generateDataPoints(days) {
                const data = [];
                const today = new Date();

                for (let i = days - 1; i >= 0; i--) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);

                    // Generate realistic learning data with some patterns
                    const isWeekend = date.getDay() === 0 || date.getDay() === 6;
                    const baseStudyTime = isWeekend ? 45 : 75; // Less study on weekends
                    const baseProblemsSolved = isWeekend ? 8 : 15;

                    data.push({
                        date: date.toISOString().split('T')[0],
                        displayDate: date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),
                        studyTime: Math.max(0, baseStudyTime + Math.random() * 60 - 30),
                        problemsSolved: Math.max(0, baseProblemsSolved + Math.random() * 10 - 5),
                        topicsLearned: Math.floor(Math.random() * 5) + 1,
                        progressPercentage: Math.min(100, 60 + Math.random() * 40)
                    });
                }

                return data;
            }

            createChart() {
                const ctx = document.getElementById('progressChart').getContext('2d');
                const data = this.chartData[this.currentPeriod];

                // Destroy existing chart if it exists
                if (this.chart) {
                    this.chart.destroy();
                }

                const chartConfig = this.getChartConfig(data);
                this.chart = new Chart(ctx, chartConfig);

                // Update data points counter
                document.getElementById('dataPoints').textContent = `Data points: ${data.length}`;
            }

            getChartConfig(data) {
                const labels = data.map(d => d.displayDate);
                const studyTimeData = data.map(d => Math.round(d.studyTime));
                const problemsData = data.map(d => Math.round(d.problemsSolved));

                const baseConfig = {
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Study Time (minutes)',
                                data: studyTimeData,
                                borderColor: '#043178',
                                backgroundColor: this.currentChartType === 'line' ? 'rgba(4, 49, 120, 0.1)' : 'rgba(4, 49, 120, 0.6)',
                                tension: 0.4,
                                fill: this.currentChartType === 'area'
                            },
                            {
                                label: 'Problems Solved',
                                data: problemsData,
                                borderColor: '#6048EB',
                                backgroundColor: this.currentChartType === 'line' ? 'rgba(96, 72, 235, 0.1)' : 'rgba(96, 72, 235, 0.6)',
                                tension: 0.4,
                                fill: this.currentChartType === 'area'
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        },
                        // Mobile-optimized touch interactions
                        onHover: (event, activeElements) => {
                            if (window.innerWidth <= 640 && activeElements.length > 0) {
                                // Provide haptic feedback on mobile hover
                                if ('vibrate' in navigator) {
                                    navigator.vibrate(25);
                                }
                            }
                        },
                        plugins: {
                            tooltip: {
                                backgroundColor: 'rgba(255, 255, 255, 0.95)',
                                titleColor: '#374151',
                                bodyColor: '#6B7280',
                                borderColor: '#E5E7EB',
                                borderWidth: 1,
                                cornerRadius: 8,
                                displayColors: true,
                                // Mobile-optimized tooltip
                                titleFont: {
                                    size: window.innerWidth <= 640 ? 14 : 12
                                },
                                bodyFont: {
                                    size: window.innerWidth <= 640 ? 13 : 11
                                },
                                padding: window.innerWidth <= 640 ? 12 : 8,
                                callbacks: {
                                    title: (context) => {
                                        const dataIndex = context[0].dataIndex;
                                        const dataPoint = data[dataIndex];
                                        return `${dataPoint.displayDate} - ${dataPoint.progressPercentage.toFixed(1)}% progress`;
                                    },
                                    afterBody: (context) => {
                                        const dataIndex = context[0].dataIndex;
                                        const dataPoint = data[dataIndex];
                                        const avgStudyTime = studyTimeData.reduce((a, b) => a + b, 0) / studyTimeData.length;
                                        const avgProblems = problemsData.reduce((a, b) => a + b, 0) / problemsData.length;

                                        return [
                                            `Topics learned: ${dataPoint.topicsLearned}`,
                                            `Study time vs avg: ${dataPoint.studyTime > avgStudyTime ? '+' : ''}${(dataPoint.studyTime - avgStudyTime).toFixed(0)} min`,
                                            `Problems vs avg: ${dataPoint.problemsSolved > avgProblems ? '+' : ''}${(dataPoint.problemsSolved - avgProblems).toFixed(0)}`
                                        ];
                                    }
                                }
                            },
                            legend: {
                                position: 'bottom',
                                labels: {
                                    usePointStyle: true,
                                    padding: 20,
                                    font: {
                                        size: 12
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.1)'
                                },
                                ticks: {
                                    color: '#6B7280',
                                    font: {
                                        size: window.innerWidth <= 640 ? 11 : 10
                                    }
                                }
                            },
                            x: {
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.1)'
                                },
                                ticks: {
                                    color: '#6B7280',
                                    font: {
                                        size: window.innerWidth <= 640 ? 11 : 10
                                    },
                                    maxRotation: window.innerWidth <= 640 ? 45 : 0,
                                    minRotation: window.innerWidth <= 640 ? 45 : 0
                                }
                            }
                        },
                        animation: {
                            duration: 750,
                            easing: 'easeInOutQuart'
                        }
                    }
                };

                // Set chart type
                if (this.currentChartType === 'bar') {
                    baseConfig.type = 'bar';
                    baseConfig.data.datasets.forEach(dataset => {
                        dataset.tension = 0;
                        dataset.fill = false;
                    });
                } else {
                    baseConfig.type = 'line';
                    if (this.currentChartType === 'area') {
                        baseConfig.data.datasets.forEach(dataset => {
                            dataset.fill = true;
                        });
                    }
                }

                return baseConfig;
            }

            handleChartTypeChange(button) {
                // Update active state
                document.querySelectorAll('.chart-type-btn').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');

                // Update chart type
                if (button.id === 'lineChartBtn') this.currentChartType = 'line';
                else if (button.id === 'barChartBtn') this.currentChartType = 'bar';
                else if (button.id === 'areaChartBtn') this.currentChartType = 'area';

                // Recreate chart with new type
                this.createChart();
            }

            handlePeriodChange(button) {
                // Update active state
                document.querySelectorAll('.period-btn').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');

                // Update period
                this.currentPeriod = parseInt(button.dataset.period);

                // Recreate chart with new data
                this.createChart();
            }

            updateLastUpdated() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('en-US', {
                    hour: 'numeric',
                    minute: '2-digit',
                    hour12: true
                });
                document.getElementById('lastUpdated').textContent = `Last updated: ${timeString}`;

                // Update every 5 minutes as per business rules
                setTimeout(() => this.updateLastUpdated(), 5 * 60 * 1000);
            }
        }

        // Initialize the interactive charts when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new InteractiveProgressCharts();
        });

        // Interactive Next Steps Functions
        function startMathSession() {
            console.log('Starting Math session...');

            // Show loading state
            showActionFeedback('Starting Math session...', 'brain');

            // Simulate navigation to math session
            setTimeout(() => {
                // In a real app, this would navigate to the math learning interface
                // For demo purposes, we'll show a success message
                showActionFeedback('Math session started! Redirecting...', 'check-circle', 'success');

                // Simulate navigation after 1.5 seconds
                setTimeout(() => {
                    // This would typically be: window.parent.postMessage({action: 'navigate', page: 'chat', subject: 'math'}, '*');
                    console.log('Navigation: Opening chat interface with Math context');
                    alert('Demo: Would navigate to Math learning session in chat interface');
                }, 1500);
            }, 800);
        }

        function startScienceSession() {
            console.log('Starting Science session...');

            showActionFeedback('Starting Science session...', 'clock');

            setTimeout(() => {
                showActionFeedback('Science session started! Redirecting...', 'check-circle', 'success');

                setTimeout(() => {
                    console.log('Navigation: Opening chat interface with Science context');
                    alert('Demo: Would navigate to Science learning session in chat interface');
                }, 1500);
            }, 800);
        }

        function createHistoryChallenge() {
            console.log('Creating History challenge...');

            showActionFeedback('Creating new History challenge...', 'star');

            setTimeout(() => {
                showActionFeedback('Challenge created! Opening goals...', 'check-circle', 'success');

                setTimeout(() => {
                    console.log('Navigation: Opening goals interface with History challenge');
                    alert('Demo: Would navigate to Goals interface to set up History challenge');
                }, 1500);
            }, 800);
        }

        function viewAllGoals() {
            console.log('Viewing all goals...');

            showActionFeedback('Loading goals...', 'target');

            setTimeout(() => {
                console.log('Navigation: Opening goals interface');
                alert('Demo: Would navigate to Goals management interface');
            }, 800);
        }

        // Action feedback system
        function showActionFeedback(message, icon, type = 'info') {
            // Remove existing feedback
            const existingFeedback = document.getElementById('actionFeedback');
            if (existingFeedback) {
                existingFeedback.remove();
            }

            // Create feedback element
            const feedback = document.createElement('div');
            feedback.id = 'actionFeedback';
            feedback.className = `fixed top-4 right-4 z-50 flex items-center space-x-3 px-4 py-3 rounded-lg shadow-lg transition-all duration-300 transform translate-x-full`;

            // Set colors based on type - Using brand colors
            const colors = {
                info: 'bg-ayah-primary text-white',
                success: 'bg-ayah-primary text-white',
                warning: 'bg-ayah-icon-secondary text-white',
                error: 'bg-ayah-icon-tertiary text-white'
            };

            feedback.className += ` ${colors[type] || colors.info}`;

            feedback.innerHTML = `
                <i data-lucide="${icon}" class="w-5 h-5"></i>
                <span class="font-medium">${message}</span>
            `;

            document.body.appendChild(feedback);

            // Initialize Lucide icons for the new element
            lucide.createIcons();

            // Animate in
            setTimeout(() => {
                feedback.classList.remove('translate-x-full');
            }, 100);

            // Auto-remove after 3 seconds
            setTimeout(() => {
                feedback.classList.add('translate-x-full');
                setTimeout(() => {
                    if (feedback.parentNode) {
                        feedback.remove();
                    }
                }, 300);
            }, 3000);
        }

        // Add click handlers for buttons
        document.addEventListener('click', function(e) {
            if (e.target.matches('button')) {
                const buttonText = e.target.textContent.trim();
                console.log('Progress action clicked:', buttonText);

                // Simple visual feedback
                e.target.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    e.target.style.transform = 'scale(1)';
                }, 150);
            }
        });
    </script>
</body>
</html>
