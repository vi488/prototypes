<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Subject Progress - Ayah</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Ayah Educational AI Platform - Comprehensive Design System */
        :root {
            /* Brand Color Hierarchy - Wisdom Purple System */
            --ayah-primary: #6048EB;           /* Main brand - AI responses, primary actions */
            --ayah-primary-hover: #4F3BC9;     /* Interactive states - button hover, link hover */
            --ayah-primary-light: #F4F1FF;     /* AI message backgrounds, subtle highlights */
            --ayah-primary-lighter: #F4FDFF;   /* Page backgrounds, card backgrounds */
            --ayah-primary-dark: #3A2A9E;      /* High emphasis text, important icons */

            /* Educational Context Applications */
            --ayah-lesson-active: #6048EB;     /* Active lesson indicator */
            --ayah-progress-fill: #6048EB;     /* Progress bar fill color */
            --ayah-achievement-glow: #6048EB;  /* Achievement badge glow effect */
            --ayah-ai-accent: #F4F1FF;         /* AI tutor message background */

            /* Enhanced Subject-Specific Color Coding - Maximum Differentiation */
            /* STEM Subjects - Cool, Analytical Colors */
            --ayah-math: #6048EB;              /* Primary purple - logical thinking */
            --ayah-science: #059669;           /* Emerald green - growth, discovery */
            --ayah-technology: #0891B2;        /* Cyan blue - innovation, digital */

            /* Language Arts - Warm, Creative Colors */
            --ayah-english: #DC2626;           /* Red - passion, literature, expression */
            --ayah-reading: #EA580C;           /* Orange-red - warmth, storytelling */
            --ayah-writing: #D97706;           /* Amber - creativity, ideas */

            /* Social Studies - Earthy, Grounding Colors */
            --ayah-history: #A16207;           /* Golden brown - heritage, tradition */
            --ayah-geography: #166534;         /* Forest green - earth, exploration */
            --ayah-civics: #1E40AF;            /* Royal blue - authority, governance */

            /* Arts & Enrichment - Vibrant, Inspiring Colors */
            --ayah-art: #BE185D;               /* Magenta - creativity, artistic expression */
            --ayah-music: #7C2D12;             /* Deep orange - rhythm, harmony */
            --ayah-other: #6B7280;             /* Neutral gray - general subjects */

            /* Enhanced Subject Light Background Variants - Maximum Differentiation */
            --ayah-math-light: #F4F1FF;        /* Math background - logical clarity */
            --ayah-science-light: #ECFDF5;      /* Science background - natural growth */
            --ayah-english-light: #FEF2F2;      /* English background - literary warmth */
            --ayah-history-light: #FFFBEB;      /* History background - heritage gold */
            --ayah-art-light: #FDF2F8;          /* Art background - creative pink */
            --ayah-technology-light: #F0F9FF;   /* Technology background - digital blue */
            --ayah-geography-light: #F0FDF4;    /* Geography background - earth green */
            --ayah-civics-light: #EFF6FF;       /* Civics background - authority blue */
            --ayah-music-light: #FFF7ED;        /* Music background - harmonic orange */
            --ayah-reading-light: #FFF7ED;      /* Reading background - storytelling warmth */
            --ayah-writing-light: #FFFBEB;      /* Writing background - creative amber */
            --ayah-other-light: #F9FAFB;        /* Other background - neutral */

            /* Educational Interaction Colors - Learning Feedback System */
            --ayah-correct: #22C55E;           /* Bright, encouraging green */
            --ayah-correct-bg: #DCFCE7;        /* Light green background */
            --ayah-correct-border: #16A34A;    /* Darker green border */
            --ayah-learning: #F59E0B;          /* Warm, non-threatening orange */
            --ayah-learning-bg: #FEF3C7;       /* Light orange background */
            --ayah-learning-border: #D97706;   /* Darker orange border */
            --ayah-hint: #3B82F6;              /* Friendly, helpful blue */
            --ayah-hint-bg: #DBEAFE;           /* Light blue background */
            --ayah-hint-border: #2563EB;       /* Darker blue border */
            --ayah-achievement: #F59E0B;       /* Warm gold for achievements */
            --ayah-achievement-glow: #FCD34D;  /* Golden glow effect */
            --ayah-achievement-bg: #FFFBEB;    /* Light gold background */

            /* Age-Appropriate Color Variations */
            /* Elementary (K-5) - Brighter, More Playful */
            --ayah-elementary-primary: #7B5EF0;    /* Slightly brighter purple */
            --ayah-elementary-success: #22C55E;     /* Brighter green for achievements */
            --ayah-elementary-fun: #F59E0B;         /* Warm orange for gamification */
            --ayah-elementary-bg: #F4F1FF;          /* Light, cheerful backgrounds */

            /* Middle School (6-8) - Balanced, Engaging */
            --ayah-middle-primary: #6048EB;         /* Standard brand purple */
            --ayah-middle-success: #10B981;         /* Standard success green */
            --ayah-middle-accent: #8B5CF6;          /* Slightly mature purple */
            --ayah-middle-bg: #F4F1FF;              /* Standard light backgrounds */

            /* High School (9-12) - Sophisticated, Professional */
            --ayah-high-primary: #4F3BC9;           /* Darker, more serious purple */
            --ayah-high-success: #059669;           /* Deeper success green */
            --ayah-high-accent: #6366F1;            /* Professional indigo accent */
            --ayah-high-bg: #F8FAFC;                /* Neutral, focused backgrounds */

            /* Semantic Color System - Universal Meanings */
            --semantic-success: #10B981;       /* Emerald 500 */
            --semantic-success-light: #D1FAE5; /* Emerald 100 */
            --semantic-success-dark: #047857;  /* Emerald 700 */
            --semantic-error: #EF4444;         /* Red 500 */
            --semantic-error-light: #FEE2E2;   /* Red 100 */
            --semantic-error-dark: #DC2626;    /* Red 600 */
            --semantic-info: #3B82F6;          /* Blue 500 */
            --semantic-info-light: #DBEAFE;    /* Blue 100 */
            --semantic-info-dark: #1D4ED8;     /* Blue 700 */
            --semantic-warning: #F59E0B;       /* Amber 500 */
            --semantic-warning-light: #FEF3C7; /* Amber 100 */
            --semantic-warning-dark: #D97706;  /* Amber 600 */

            /* Neutral Color System - 9-11 variations */
            --neutral-50: #FAFAFA;   /* Lightest background */
            --neutral-100: #F5F5F5;  /* Light background */
            --neutral-200: #E5E5E5;  /* Border light */
            --neutral-300: #D4D4D4;  /* Border medium */
            --neutral-400: #A3A3A3;  /* Placeholder text */
            --neutral-500: #737373;  /* Secondary text */
            --neutral-600: #525252;  /* Primary text light */
            --neutral-700: #404040;  /* Primary text */
            --neutral-800: #262626;  /* Headings */
            --neutral-900: #171717;  /* High emphasis text */

            /* Spacing System - 8px Base Grid */
            --space-1: 4px;   /* 0.25rem - Micro spacing */
            --space-2: 8px;   /* 0.5rem - Base unit */
            --space-3: 12px;  /* 0.75rem - Small spacing */
            --space-4: 16px;  /* 1rem - Medium spacing */
            --space-5: 20px;  /* 1.25rem - Large spacing */
            --space-6: 24px;  /* 1.5rem - XL spacing */
            --space-8: 32px;  /* 2rem - XXL spacing */
            --space-10: 40px; /* 2.5rem - Section spacing */
            --space-12: 48px; /* 3rem - Page spacing */
            --space-16: 64px; /* 4rem - Major section spacing */
            --space-20: 80px; /* 5rem - Page margins */

            /* Typography Scale - Modular Scale: 1.250 (Major Third) */
            --text-display-large: 57px;   /* Hero headlines */
            --text-display-medium: 45px;  /* Page titles */
            --text-display-small: 36px;   /* Section headers */
            --text-headline-large: 32px;  /* Card titles */
            --text-headline-medium: 28px; /* Subsection headers */
            --text-headline-small: 24px;  /* Component titles */
            --text-title-large: 22px;     /* List headers */
            --text-title-medium: 16px;    /* Button text, labels */
            --text-title-small: 14px;     /* Captions, metadata */
            --text-body-large: 16px;      /* Primary body text */
            --text-body-medium: 14px;     /* Secondary body text */
            --text-body-small: 12px;      /* Fine print, disclaimers */

            /* Component Design Standards */
            --border-radius-small: 8px;   /* Modern feel */
            --border-radius-medium: 12px; /* Cards and containers */
            --border-radius-large: 16px;  /* Modals and major components */
            --border-radius-pill: 24px;   /* Pill-shaped CTAs */

            /* Shadow System */
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.1);     /* Subtle elevation */
            --shadow-md: 0 4px 12px rgba(0,0,0,0.15);   /* Medium elevation */
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.2);    /* High elevation */
            --shadow-xl: 0 12px 32px rgba(0,0,0,0.25);  /* Maximum elevation */
        }

        /* Educational AI Platform Typography */
        body {
            font-family: "SF Pro Display", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--neutral-50);
            color: var(--neutral-700);
            line-height: 1.5;
        }

        /* CSS Custom Properties for Dynamic Theming */
        .bg-ayah-primary { background-color: var(--ayah-primary); }
        .text-ayah-primary { color: var(--ayah-primary); }
        .border-ayah-primary { border-color: var(--ayah-primary); }
        .hover\:bg-ayah-primary:hover { background-color: var(--ayah-primary-hover); }
        .bg-ayah-primary-light { background-color: var(--ayah-primary-light); }
        .text-ayah-primary-dark { color: var(--ayah-primary-dark); }

        /* Enhanced Subject-Specific Color Classes with Educational Psychology */
        .subject-math { color: var(--ayah-math); }
        .subject-science { color: var(--ayah-science); }
        .subject-english { color: var(--ayah-english); }
        .subject-history { color: var(--ayah-history); }
        .subject-art { color: var(--ayah-art); }
        .subject-music { color: var(--ayah-music); }
        .subject-technology { color: var(--ayah-technology); }
        .subject-geography { color: var(--ayah-geography); }
        .subject-civics { color: var(--ayah-civics); }
        .subject-reading { color: var(--ayah-reading); }
        .subject-writing { color: var(--ayah-writing); }
        .subject-other { color: var(--ayah-other); }

        .bg-subject-math { background-color: var(--ayah-math); }
        .bg-subject-science { background-color: var(--ayah-science); }
        .bg-subject-english { background-color: var(--ayah-english); }
        .bg-subject-history { background-color: var(--ayah-history); }
        .bg-subject-art { background-color: var(--ayah-art); }
        .bg-subject-music { background-color: var(--ayah-music); }
        .bg-subject-technology { background-color: var(--ayah-technology); }
        .bg-subject-geography { background-color: var(--ayah-geography); }
        .bg-subject-civics { background-color: var(--ayah-civics); }
        .bg-subject-reading { background-color: var(--ayah-reading); }
        .bg-subject-writing { background-color: var(--ayah-writing); }
        .bg-subject-other { background-color: var(--ayah-other); }

        /* Enhanced Subject Light Background Classes for Maximum Differentiation */
        .bg-subject-math-light { background-color: var(--ayah-math-light); }
        .bg-subject-science-light { background-color: var(--ayah-science-light); }
        .bg-subject-english-light { background-color: var(--ayah-english-light); }
        .bg-subject-history-light { background-color: var(--ayah-history-light); }
        .bg-subject-art-light { background-color: var(--ayah-art-light); }
        .bg-subject-music-light { background-color: var(--ayah-music-light); }
        .bg-subject-technology-light { background-color: var(--ayah-technology-light); }
        .bg-subject-geography-light { background-color: var(--ayah-geography-light); }
        .bg-subject-civics-light { background-color: var(--ayah-civics-light); }
        .bg-subject-reading-light { background-color: var(--ayah-reading-light); }
        .bg-subject-writing-light { background-color: var(--ayah-writing-light); }
        .bg-subject-other-light { background-color: var(--ayah-other-light); }

        /* Enhanced Subject Border Classes for Consistent Theming */
        .border-subject-math { border-color: var(--ayah-math); }
        .border-subject-science { border-color: var(--ayah-science); }
        .border-subject-english { border-color: var(--ayah-english); }
        .border-subject-history { border-color: var(--ayah-history); }
        .border-subject-art { border-color: var(--ayah-art); }
        .border-subject-music { border-color: var(--ayah-music); }
        .border-subject-technology { border-color: var(--ayah-technology); }
        .border-subject-geography { border-color: var(--ayah-geography); }
        .border-subject-civics { border-color: var(--ayah-civics); }
        .border-subject-reading { border-color: var(--ayah-reading); }
        .border-subject-writing { border-color: var(--ayah-writing); }
        .border-subject-other { border-color: var(--ayah-other); }

        /* Educational Feedback Classes */
        .feedback-correct {
            background-color: var(--ayah-correct-bg);
            color: var(--ayah-correct-border);
            border: 1px solid var(--ayah-correct-border);
            border-radius: var(--border-radius-small);
            padding: var(--space-2) var(--space-3);
        }
        .feedback-learning {
            background-color: var(--ayah-learning-bg);
            color: var(--ayah-learning-border);
            border: 1px solid var(--ayah-learning-border);
            border-radius: var(--border-radius-small);
            padding: var(--space-2) var(--space-3);
        }
        .feedback-hint {
            background-color: var(--ayah-hint-bg);
            color: var(--ayah-hint-border);
            border: 1px solid var(--ayah-hint-border);
            border-radius: var(--border-radius-small);
            padding: var(--space-2) var(--space-3);
        }

        /* Age-Appropriate Design Classes */
        .elementary-design {
            --current-primary: var(--ayah-elementary-primary);
            --current-success: var(--ayah-elementary-success);
            --current-bg: var(--ayah-elementary-bg);
        }
        .middle-design {
            --current-primary: var(--ayah-middle-primary);
            --current-success: var(--ayah-middle-success);
            --current-bg: var(--ayah-middle-bg);
        }
        .high-design {
            --current-primary: var(--ayah-high-primary);
            --current-success: var(--ayah-high-success);
            --current-bg: var(--ayah-high-bg);
        }

        /* Component Design Standards */
        .subject-card {
            border-radius: var(--border-radius-medium);
            box-shadow: var(--shadow-sm);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            background-color: white;
            overflow: hidden;
            border: 1px solid var(--neutral-200);
        }

        .subject-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* Button Design Standards */
        .btn-primary {
            background-color: var(--ayah-primary);
            color: white;
            padding: var(--space-3) var(--space-4);
            border-radius: var(--border-radius-small);
            font-size: var(--text-title-medium);
            font-weight: 500;
            transition: background-color 0.2s ease, transform 0.1s ease;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-height: 48px; /* Touch target minimum */
        }

        .btn-primary:hover {
            background-color: var(--ayah-primary-hover);
            transform: translateY(-1px);
        }

        .btn-primary:active {
            transform: scale(0.98);
        }

        /* Typography Classes */
        .text-display-large { font-size: var(--text-display-large); line-height: 1.1; }
        .text-display-medium { font-size: var(--text-display-medium); line-height: 1.15; }
        .text-headline-large { font-size: var(--text-headline-large); line-height: 1.25; }
        .text-headline-medium { font-size: var(--text-headline-medium); line-height: 1.3; }
        .text-title-large { font-size: var(--text-title-large); line-height: 1.3; }
        .text-body-large { font-size: var(--text-body-large); line-height: 1.5; }
        .text-body-medium { font-size: var(--text-body-medium); line-height: 1.4; }

        /* Responsive Design - Mobile-First Approach */
        @media (max-width: 767px) {
            :root {
                /* Mobile typography adjustments */
                --text-display-large: 36px;
                --text-display-medium: 32px;
                --text-headline-large: 28px;
                --text-headline-medium: 24px;
            }

            .subject-card {
                margin-bottom: var(--space-4);
            }
        }

        @media (min-width: 768px) and (max-width: 1023px) {
            /* Tablet-specific adjustments */
            .subject-card {
                margin-bottom: var(--space-5);
            }
        }

        @media (min-width: 1024px) {
            /* Desktop-specific adjustments */
            .subject-card {
                margin-bottom: var(--space-6);
            }
        }

        /* Dark Mode Support */
        @media (prefers-color-scheme: dark) {
            :root {
                /* Adjusted brand colors for dark mode */
                --ayah-primary: #8B5CF6;              /* Lighter purple for dark backgrounds */
                --ayah-primary-light: #1E1B4B;        /* Dark purple background */
                --ayah-primary-lighter: #0F0F23;      /* Very dark background */

                /* Educational feedback in dark mode */
                --ayah-correct: #34D399;              /* Brighter green for visibility */
                --ayah-learning: #FBBF24;             /* Brighter orange for contrast */
                --ayah-hint: #60A5FA;                 /* Brighter blue for readability */

                /* Neutral colors for dark mode */
                --neutral-50: #0F0F23;
                --neutral-100: #1E1B4B;
                --neutral-200: #262626;
                --neutral-300: #404040;
                --neutral-400: #525252;
                --neutral-500: #737373;
                --neutral-600: #A3A3A3;
                --neutral-700: #D4D4D4;
                --neutral-800: #E5E5E5;
                --neutral-900: #F5F5F5;
            }

            .subject-card {
                background-color: var(--neutral-100);
                color: var(--neutral-800);
                border-color: var(--neutral-300);
            }
        }

        /* Accessibility Enhancements */
        .focus-visible {
            outline: 2px solid var(--ayah-primary);
            outline-offset: 2px;
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            :root {
                --ayah-primary: #4F3BC9;
                --ayah-math: #4F3BC9;
                --ayah-science: #1D4ED8;
                --ayah-english: #7C3AED;
                --ayah-history: #BE185D;
            }
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            .subject-card,
            .btn-primary {
                transition: none;
            }

            .subject-card:hover {
                transform: none;
            }

            .btn-primary:hover {
                transform: none;
            }

            .fade-in {
                animation: none;
            }
        }

        /* Animation classes */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .subject-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .subject-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .progress-bar {
            transition: width 0.8s ease-in-out;
        }

        /* Mobile responsive adjustments */
        @media (max-width: 640px) {
            .subject-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .comparison-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            /* Mobile-optimized subject cards */
            .subject-card {
                padding: 1rem !important;
                margin-bottom: 1rem;
            }

            .subject-card h3 {
                font-size: 1.125rem !important;
            }

            /* Touch-friendly buttons */
            .mobile-touch-btn {
                min-height: 44px;
                min-width: 44px;
                padding: 0.75rem;
            }

            /* Mobile text sizing */
            .mobile-text-sm {
                font-size: 0.875rem;
            }

            .mobile-text-lg {
                font-size: 1.125rem;
            }

            /* Mobile progress bars */
            .mobile-progress-bar {
                height: 8px !important;
            }

            /* Mobile expandable sections */
            .mobile-expandable {
                transition: max-height 0.3s ease-in-out;
                overflow: hidden;
            }

            .mobile-expandable.collapsed {
                max-height: 0;
            }

            .mobile-expandable.expanded {
                max-height: 500px;
            }
        }

        /* Tablet optimization */
        @media (min-width: 641px) and (max-width: 1024px) {
            .subject-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .tablet-grid-2 {
                grid-template-columns: repeat(2, 1fr) !important;
            }
        }

        /* Touch feedback */
        .touch-feedback {
            transition: all 0.15s ease;
        }

        .touch-feedback:active {
            transform: scale(0.98);
            background-color: rgba(96, 72, 235, 0.05);
        }

        /* Swipe navigation indicators */
        .swipe-indicator {
            display: none;
            text-align: center;
            color: #9CA3AF;
            font-size: 0.75rem;
            margin-top: 0.5rem;
        }

        @media (max-width: 640px) {
            .swipe-indicator {
                display: block;
            }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <div class="p-6">
        <!-- Header - Mobile Optimized -->
        <div class="mb-6 sm:mb-8">
            <div class="flex flex-col sm:flex-row sm:items-center justify-between">
                <div class="mb-4 sm:mb-0">
                    <h1 class="text-2xl sm:text-3xl font-bold text-gray-800 mb-2">📚 Subject Breakdown Analytics</h1>
                    <p class="text-gray-600 text-sm sm:text-base">Understand your strengths and areas for improvement across different academic subjects</p>
                    <p class="text-xs sm:text-sm text-gray-500 mt-1">Last updated: Today at 2:30 PM</p>
                </div>
                <div class="flex items-center space-x-2">
                    <button onclick="refreshProgress()" class="touch-feedback flex items-center space-x-2 px-3 sm:px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors mobile-touch-btn">
                        <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                        <span class="hidden sm:inline">Refresh</span>
                    </button>
                    <button onclick="exportData()" class="touch-feedback flex items-center space-x-2 px-3 sm:px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors mobile-touch-btn">
                        <i data-lucide="download" class="w-4 h-4"></i>
                        <span class="hidden sm:inline">Export</span>
                    </button>
                </div>
            </div>
            <!-- Mobile navigation hint -->
            <div class="swipe-indicator mt-4">
                <i data-lucide="chevrons-left-right" class="w-4 h-4 inline mr-1"></i>
                Swipe subject cards to explore details
            </div>
        </div>


        <!-- Subject Performance Overview -->
        <div class="mb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-6">Subject Performance Overview</h2>
            <div class="subject-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Math Subject Card -->
                <div class="subject-card bg-white rounded-xl border border-gray-200 p-6" onclick="showSubjectDetails('math')">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-subject-math-light rounded-lg flex items-center justify-center">
                                <i data-lucide="calculator" class="w-6 h-6 text-subject-math"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-gray-800">Math</h3>
                                <p class="text-sm text-gray-500">Algebra & Geometry</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-subject-math">78%</div>
                            <div class="text-xs text-gray-500">Progress</div>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">Problems Solved</span>
                            <span class="font-medium">142</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">Time Spent</span>
                            <span class="font-medium">8.5 hrs</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">Current Streak</span>
                            <span class="font-medium text-green-600">5 days</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2 mt-4">
                            <div class="progress-bar bg-subject-math h-2 rounded-full" style="width: 78%"></div>
                        </div>
                    </div>
                </div>

                <!-- Science Subject Card -->
                <div class="subject-card bg-white rounded-xl border border-gray-200 p-6" onclick="showSubjectDetails('science')">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-subject-science-light rounded-lg flex items-center justify-center">
                                <i data-lucide="flask-conical" class="w-6 h-6 text-subject-science"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-gray-800">Science</h3>
                                <p class="text-sm text-gray-500">Biology & Chemistry</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-subject-science">85%</div>
                            <div class="text-xs text-gray-500">Progress</div>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">Topics Learned</span>
                            <span class="font-medium">23</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">Experiments</span>
                            <span class="font-medium">12</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">Time Spent</span>
                            <span class="font-medium">12.2 hrs</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2 mt-4">
                            <div class="progress-bar bg-subject-science h-2 rounded-full" style="width: 85%"></div>
                        </div>
                    </div>
                </div>

                <!-- English Subject Card -->
                <div class="subject-card bg-white rounded-xl border border-gray-200 p-6" onclick="showSubjectDetails('english')">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-subject-english-light rounded-lg flex items-center justify-center">
                                <i data-lucide="book-open" class="w-6 h-6 text-subject-english"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-gray-800">English</h3>
                                <p class="text-sm text-gray-500">Literature & Writing</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-subject-english">72%</div>
                            <div class="text-xs text-gray-500">Progress</div>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">Reading Time</span>
                            <span class="font-medium">15.3 hrs</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">Writing Exercises</span>
                            <span class="font-medium">28</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">Vocabulary</span>
                            <span class="font-medium">156 words</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2 mt-4">
                            <div class="progress-bar bg-subject-english h-2 rounded-full" style="width: 72%"></div>
                        </div>
                    </div>
                </div>

                <!-- History Subject Card -->
                <div class="subject-card bg-white rounded-xl border border-gray-200 p-6" onclick="showSubjectDetails('history')">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-subject-history-light rounded-lg flex items-center justify-center">
                                <i data-lucide="scroll" class="w-6 h-6 text-subject-history"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-gray-800">History</h3>
                                <p class="text-sm text-gray-500">World & US History</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold text-subject-history">91%</div>
                            <div class="text-xs text-gray-500">Progress</div>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">Topics Covered</span>
                            <span class="font-medium">18</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">Time Spent</span>
                            <span class="font-medium">9.7 hrs</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">Concepts Mastered</span>
                            <span class="font-medium">34</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2 mt-4">
                            <div class="progress-bar bg-subject-history h-2 rounded-full" style="width: 91%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Strongest Subject Highlight -->
            <div class="mt-6 bg-subject-history-light border border-subject-history rounded-lg p-4">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-subject-history-light rounded-full flex items-center justify-center">
                        <i data-lucide="trophy" class="w-4 h-4 text-subject-history"></i>
                    </div>
                    <div>
                        <p class="font-medium text-subject-history">Your strongest subject this week: History</p>
                        <p class="text-sm text-subject-history">Great consistency and progress! Keep it up!</p>
                    </div>
                </div>
            </div>

            <!-- Needs Attention Alert -->
            <div class="mt-4 bg-subject-english-light border border-subject-english rounded-lg p-4">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-subject-english-light rounded-full flex items-center justify-center">
                        <i data-lucide="alert-circle" class="w-4 h-4 text-subject-english"></i>
                    </div>
                    <div>
                        <p class="font-medium text-subject-english">English needs more practice</p>
                        <p class="text-sm text-subject-english">Try spending 10 more minutes daily to reach your weekly goal</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Subject Comparison Visualization -->
        <div class="mb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-6">Subject Comparison</h2>
            <div class="comparison-grid grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Time Spent Chart -->
                <div class="bg-white rounded-xl border border-gray-200 p-6">
                    <h3 class="font-semibold text-gray-800 mb-4">Time Spent This Week</h3>
                    <div class="h-64">
                        <canvas id="timeSpentChart"></canvas>
                    </div>
                </div>

                <!-- Goal Completion Chart -->
                <div class="bg-white rounded-xl border border-gray-200 p-6">
                    <h3 class="font-semibold text-gray-800 mb-4">Goal Completion</h3>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-4 h-4 bg-subject-math rounded"></div>
                                <span class="text-sm font-medium">Math</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-32 bg-gray-200 rounded-full h-2">
                                    <div class="bg-subject-math h-2 rounded-full" style="width: 78%"></div>
                                </div>
                                <span class="text-sm font-medium text-gray-600">78%</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-4 h-4 bg-subject-science rounded"></div>
                                <span class="text-sm font-medium">Science</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-32 bg-gray-200 rounded-full h-2">
                                    <div class="bg-subject-science h-2 rounded-full" style="width: 85%"></div>
                                </div>
                                <span class="text-sm font-medium text-gray-600">85%</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-4 h-4 bg-subject-english rounded"></div>
                                <span class="text-sm font-medium">English</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-32 bg-gray-200 rounded-full h-2">
                                    <div class="bg-subject-english h-2 rounded-full" style="width: 72%"></div>
                                </div>
                                <span class="text-sm font-medium text-gray-600">72%</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-4 h-4 bg-subject-history rounded"></div>
                                <span class="text-sm font-medium">History</span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <div class="w-32 bg-gray-200 rounded-full h-2">
                                    <div class="bg-subject-history h-2 rounded-full" style="width: 91%"></div>
                                </div>
                                <span class="text-sm font-medium text-gray-600">91%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Activity Indicators -->
                <div class="bg-white rounded-xl border border-gray-200 p-6">
                    <h3 class="font-semibold text-gray-800 mb-4">Weekly Activity</h3>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium">Math</span>
                            <div class="flex space-x-1">
                                <div class="w-6 h-6 bg-subject-math rounded text-white text-xs flex items-center justify-center">5</div>
                                <span class="text-xs text-gray-500 ml-2">days active</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium">Science</span>
                            <div class="flex space-x-1">
                                <div class="w-6 h-6 bg-subject-science rounded text-white text-xs flex items-center justify-center">7</div>
                                <span class="text-xs text-gray-500 ml-2">days active</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium">English</span>
                            <div class="flex space-x-1">
                                <div class="w-6 h-6 bg-subject-english rounded text-white text-xs flex items-center justify-center">4</div>
                                <span class="text-xs text-gray-500 ml-2">days active</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium">History</span>
                            <div class="flex space-x-1">
                                <div class="w-6 h-6 bg-subject-history rounded text-white text-xs flex items-center justify-center">6</div>
                                <span class="text-xs text-gray-500 ml-2">days active</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Performance Trends -->
                <div class="bg-white rounded-xl border border-gray-200 p-6">
                    <h3 class="font-semibold text-gray-800 mb-4">Performance Trends</h3>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium">Math</span>
                            <div class="flex items-center space-x-2">
                                <i data-lucide="trending-up" class="w-4 h-4 text-green-500"></i>
                                <span class="text-sm text-green-600">+12%</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium">Science</span>
                            <div class="flex items-center space-x-2">
                                <i data-lucide="trending-up" class="w-4 h-4 text-green-500"></i>
                                <span class="text-sm text-green-600">+8%</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium">English</span>
                            <div class="flex items-center space-x-2">
                                <i data-lucide="trending-down" class="w-4 h-4 text-red-500"></i>
                                <span class="text-sm text-red-600">-3%</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-medium">History</span>
                            <div class="flex items-center space-x-2">
                                <i data-lucide="trending-up" class="w-4 h-4 text-green-500"></i>
                                <span class="text-sm text-green-600">+15%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Subject-Specific Insights & Recommendations -->
        <div class="mb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-6">📊 Insights & Recommendations</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Strongest Subject -->
                <div class="bg-white rounded-xl border border-gray-200 p-6">
                    <div class="flex items-center space-x-3 mb-4">
                        <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                            <i data-lucide="trending-up" class="w-5 h-5 text-green-600"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-800">Your Strongest Subject</h3>
                            <p class="text-sm text-gray-600">This week</p>
                        </div>
                    </div>
                    <div class="bg-subject-math-light rounded-lg p-4 mb-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="font-semibold text-gray-800">📐 Math</span>
                            <span class="text-sm font-medium text-green-600">Great consistency!</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">You study Math most consistently on weekdays - excellent routine!</p>
                        <div class="flex items-center space-x-4 text-xs text-gray-500">
                            <span>⏱️ 4.2 hrs this week</span>
                            <span>🎯 6/7 days active</span>
                        </div>
                    </div>
                </div>

                <!-- Needs Attention -->
                <div class="bg-white rounded-xl border border-gray-200 p-6">
                    <div class="flex items-center space-x-3 mb-4">
                        <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center">
                            <i data-lucide="alert-circle" class="w-5 h-5 text-orange-600"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-800">Needs More Practice</h3>
                            <p class="text-sm text-gray-600">Areas for improvement</p>
                        </div>
                    </div>
                    <div class="bg-subject-history-light rounded-lg p-4 mb-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="font-semibold text-gray-800">🏛️ History</span>
                            <span class="text-sm font-medium text-orange-600">Needs attention</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">Try spending 20 more minutes on History to reach your weekly goal</p>
                        <div class="flex items-center space-x-4 text-xs text-gray-500">
                            <span>⏱️ 1.2 hrs this week</span>
                            <span>🎯 2/7 days active</span>
                        </div>
                    </div>
                </div>

                <!-- Performance Insights -->
                <div class="bg-white rounded-xl border border-gray-200 p-6">
                    <div class="flex items-center space-x-3 mb-4">
                        <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                            <i data-lucide="zap" class="w-5 h-5 text-blue-600"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-800">Performance Insights</h3>
                            <p class="text-sm text-gray-600">Your learning patterns</p>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div class="flex items-start space-x-3 p-3 bg-blue-50 rounded-lg">
                            <i data-lucide="clock" class="w-4 h-4 text-blue-600 mt-0.5"></i>
                            <div>
                                <p class="text-sm font-medium text-gray-800">Speed Improvement</p>
                                <p class="text-xs text-gray-600">Your Science problem-solving speed has improved 25% this week!</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3 p-3 bg-green-50 rounded-lg">
                            <i data-lucide="target" class="w-4 h-4 text-green-600 mt-0.5"></i>
                            <div>
                                <p class="text-sm font-medium text-gray-800">Goal Progress</p>
                                <p class="text-xs text-gray-600">You're 80% complete with your Math goal - great progress!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Actionable Recommendations -->
                <div class="bg-white rounded-xl border border-gray-200 p-6">
                    <div class="flex items-center space-x-3 mb-4">
                        <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                            <i data-lucide="lightbulb" class="w-5 h-5 text-purple-600"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-800">Smart Recommendations</h3>
                            <p class="text-sm text-gray-600">Personalized for you</p>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div class="p-3 bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg border border-purple-100">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm font-medium text-gray-800">📚 English Focus</span>
                                <span class="text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded-full">High Priority</span>
                            </div>
                            <p class="text-xs text-gray-600 mb-2">Try spending 10 more minutes on English to reach your weekly goal</p>
                            <button class="text-xs bg-purple-600 text-white px-3 py-1 rounded-full hover:bg-purple-700 transition-colors">
                                Start English Session
                            </button>
                        </div>
                        <div class="p-3 bg-gradient-to-r from-orange-50 to-yellow-50 rounded-lg border border-orange-100">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm font-medium text-gray-800">🏛️ History Catch-up</span>
                                <span class="text-xs bg-orange-100 text-orange-700 px-2 py-1 rounded-full">Medium Priority</span>
                            </div>
                            <p class="text-xs text-gray-600 mb-2">Aim for 15 minutes of History each day this week</p>
                            <button class="text-xs bg-orange-600 text-white px-3 py-1 rounded-full hover:bg-orange-700 transition-colors">
                                Review History Topics
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Detailed Subject View Modal (Hidden by default) -->
        <div id="subjectModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
            <div class="flex items-center justify-center min-h-screen p-4">
                <div class="bg-white rounded-xl max-w-4xl w-full max-h-screen overflow-y-auto">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center space-x-3">
                                <div id="modalSubjectIcon" class="w-12 h-12 rounded-lg flex items-center justify-center">
                                    <!-- Icon will be inserted here -->
                                </div>
                                <div>
                                    <h2 id="modalSubjectTitle" class="text-2xl font-bold text-gray-800"></h2>
                                    <p id="modalSubjectSubtitle" class="text-gray-600"></p>
                                </div>
                            </div>
                            <button onclick="closeSubjectModal()" class="p-2 text-gray-400 hover:text-gray-600">
                                <i data-lucide="x" class="w-6 h-6"></i>
                            </button>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Weekly Activity Chart -->
                            <div class="bg-gray-50 rounded-lg p-4">
                                <h3 class="font-semibold text-gray-800 mb-4">Weekly Activity</h3>
                                <div class="h-48">
                                    <canvas id="weeklyActivityChart"></canvas>
                                </div>
                            </div>

                            <!-- Goal Progress -->
                            <div class="bg-gray-50 rounded-lg p-4">
                                <h3 class="font-semibold text-gray-800 mb-4">Goal Progress</h3>
                                <div id="goalProgressContent" class="space-y-3">
                                    <!-- Goal progress content will be inserted here -->
                                </div>
                            </div>

                            <!-- Achievement History -->
                            <div class="bg-gray-50 rounded-lg p-4">
                                <h3 class="font-semibold text-gray-800 mb-4">Recent Achievements</h3>
                                <div id="achievementContent" class="space-y-3">
                                    <!-- Achievement content will be inserted here -->
                                </div>
                            </div>

                            <!-- Time Patterns -->
                            <div class="bg-gray-50 rounded-lg p-4">
                                <h3 class="font-semibold text-gray-800 mb-4">Study Patterns</h3>
                                <div id="timePatternContent" class="space-y-3">
                                    <!-- Time pattern content will be inserted here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();

        // Subject data
        const subjectData = {
            math: {
                name: 'Math',
                subtitle: 'Algebra & Geometry',
                icon: 'calculator',
                color: 'var(--ayah-math)',
                bgColor: 'bg-subject-math-light',
                progress: 78,
                stats: {
                    problemsSolved: 142,
                    timeSpent: '8.5 hrs',
                    currentStreak: '5 days'
                },
                goals: [
                    { name: 'Complete Algebra Unit', progress: 85, target: 'End of month' },
                    { name: 'Master Quadratic Equations', progress: 60, target: 'Next week' }
                ],
                achievements: [
                    { name: 'Problem Solver', description: 'Solved 100+ problems', date: '2 days ago' },
                    { name: 'Streak Master', description: '5-day study streak', date: '1 day ago' }
                ],
                patterns: [
                    'Best study time: 3-5 PM',
                    'Average session: 25 minutes',
                    'Most productive on: Weekdays'
                ]
            },
            science: {
                name: 'Science',
                subtitle: 'Biology & Chemistry',
                icon: 'flask-conical',
                color: 'var(--ayah-science)',
                bgColor: 'bg-subject-science-light',
                progress: 85,
                stats: {
                    topicsLearned: 23,
                    experiments: 12,
                    timeSpent: '12.2 hrs'
                },
                goals: [
                    { name: 'Complete Chemistry Basics', progress: 90, target: 'This week' },
                    { name: 'Biology Lab Reports', progress: 75, target: 'Next month' }
                ],
                achievements: [
                    { name: 'Lab Expert', description: 'Completed 10+ experiments', date: '3 days ago' },
                    { name: 'Theory Master', description: 'Aced all quizzes', date: '1 week ago' }
                ],
                patterns: [
                    'Best study time: 10 AM - 12 PM',
                    'Average session: 35 minutes',
                    'Most productive on: Weekends'
                ]
            },
            english: {
                name: 'English',
                subtitle: 'Literature & Writing',
                icon: 'book-open',
                color: 'var(--ayah-english)',
                bgColor: 'bg-subject-english-light',
                progress: 72,
                stats: {
                    readingTime: '15.3 hrs',
                    writingExercises: 28,
                    vocabulary: '156 words'
                },
                goals: [
                    { name: 'Read 3 Classic Novels', progress: 67, target: 'End of semester' },
                    { name: 'Improve Essay Writing', progress: 80, target: 'Next month' }
                ],
                achievements: [
                    { name: 'Bookworm', description: 'Read for 15+ hours', date: '1 week ago' },
                    { name: 'Vocabulary Builder', description: 'Learned 150+ words', date: '3 days ago' }
                ],
                patterns: [
                    'Best study time: 7-9 PM',
                    'Average session: 45 minutes',
                    'Most productive on: Evenings'
                ]
            },
            history: {
                name: 'History',
                subtitle: 'World & US History',
                icon: 'scroll',
                color: 'var(--ayah-history)',
                bgColor: 'bg-subject-history-light',
                progress: 91,
                stats: {
                    topicsCovered: 18,
                    timeSpent: '9.7 hrs',
                    conceptsMastered: 34
                },
                goals: [
                    { name: 'World War II Unit', progress: 95, target: 'This week' },
                    { name: 'American Revolution Essay', progress: 85, target: 'Next week' }
                ],
                achievements: [
                    { name: 'History Buff', description: 'Mastered 30+ concepts', date: '2 days ago' },
                    { name: 'Timeline Master', description: 'Perfect chronology quiz', date: '4 days ago' }
                ],
                patterns: [
                    'Best study time: 2-4 PM',
                    'Average session: 30 minutes',
                    'Most productive on: Weekdays'
                ]
            }
        };

        // Initialize charts
        let timeSpentChart = null;
        let weeklyActivityChart = null;

        function initializeCharts() {
            // Get computed CSS custom property values
            const rootStyles = getComputedStyle(document.documentElement);
            const mathColor = rootStyles.getPropertyValue('--ayah-math').trim();
            const scienceColor = rootStyles.getPropertyValue('--ayah-science').trim();
            const englishColor = rootStyles.getPropertyValue('--ayah-english').trim();
            const historyColor = rootStyles.getPropertyValue('--ayah-history').trim();

            // Time Spent Chart
            const timeCtx = document.getElementById('timeSpentChart').getContext('2d');
            timeSpentChart = new Chart(timeCtx, {
                type: 'bar',
                data: {
                    labels: ['Math', 'Science', 'English', 'History'],
                    datasets: [{
                        label: 'Hours This Week',
                        data: [8.5, 12.2, 15.3, 9.7],
                        backgroundColor: [
                            mathColor,
                            scienceColor,
                            englishColor,
                            historyColor
                        ],
                        borderColor: [
                            mathColor,
                            scienceColor,
                            englishColor,
                            historyColor
                        ],
                        borderWidth: 2,
                        borderRadius: 8,
                        borderSkipped: false,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Hours'
                            }
                        }
                    }
                }
            });
        }

        // Show subject details modal
        function showSubjectDetails(subject) {
            const data = subjectData[subject];
            if (!data) return;

            // Resolve CSS custom property to actual color value for Chart.js
            const rootStyles = getComputedStyle(document.documentElement);
            const resolvedColor = rootStyles.getPropertyValue(data.color.replace('var(', '').replace(')', '')).trim();

            const modal = document.getElementById('subjectModal');
            const icon = document.getElementById('modalSubjectIcon');
            const title = document.getElementById('modalSubjectTitle');
            const subtitle = document.getElementById('modalSubjectSubtitle');

            // Update modal content
            icon.className = `w-12 h-12 ${data.bgColor} rounded-lg flex items-center justify-center`;
            icon.innerHTML = `<i data-lucide="${data.icon}" class="w-6 h-6" style="color: ${resolvedColor}"></i>`;
            title.textContent = data.name;
            subtitle.textContent = data.subtitle;

            // Update goal progress
            const goalContent = document.getElementById('goalProgressContent');
            goalContent.innerHTML = data.goals.map(goal => `
                <div class="flex items-center justify-between">
                    <div>
                        <p class="font-medium text-sm">${goal.name}</p>
                        <p class="text-xs text-gray-500">${goal.target}</p>
                    </div>
                    <div class="text-right">
                        <span class="text-sm font-medium">${goal.progress}%</span>
                        <div class="w-20 bg-gray-200 rounded-full h-2 mt-1">
                            <div class="h-2 rounded-full" style="width: ${goal.progress}%; background-color: ${resolvedColor}"></div>
                        </div>
                    </div>
                </div>
            `).join('');

            // Update achievements
            const achievementContent = document.getElementById('achievementContent');
            achievementContent.innerHTML = data.achievements.map(achievement => `
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0" style="background-color: ${resolvedColor}20;">
                        <i data-lucide="award" class="w-4 h-4" style="color: ${resolvedColor}"></i>
                    </div>
                    <div>
                        <p class="font-medium text-sm">${achievement.name}</p>
                        <p class="text-xs text-gray-600">${achievement.description}</p>
                        <p class="text-xs text-gray-500">${achievement.date}</p>
                    </div>
                </div>
            `).join('');

            // Update time patterns
            const timePatternContent = document.getElementById('timePatternContent');
            timePatternContent.innerHTML = data.patterns.map(pattern => `
                <div class="flex items-center space-x-2">
                    <i data-lucide="clock" class="w-4 h-4 text-gray-400"></i>
                    <span class="text-sm text-gray-600">${pattern}</span>
                </div>
            `).join('');

            // Initialize weekly activity chart for this subject
            setTimeout(() => {
                const weeklyCtx = document.getElementById('weeklyActivityChart').getContext('2d');
                if (weeklyActivityChart) {
                    weeklyActivityChart.destroy();
                }
                weeklyActivityChart = new Chart(weeklyCtx, {
                    type: 'line',
                    data: {
                        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                        datasets: [{
                            label: 'Daily Activity (minutes)',
                            data: [45, 30, 60, 25, 40, 35, 20],
                            borderColor: resolvedColor,
                            backgroundColor: resolvedColor + '20',
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Minutes'
                                }
                            }
                        }
                    }
                });
                lucide.createIcons();
            }, 100);

            modal.classList.remove('hidden');
            lucide.createIcons();
        }

        // Close subject details modal
        function closeSubjectModal() {
            document.getElementById('subjectModal').classList.add('hidden');
        }

        // Refresh progress
        function refreshProgress() {
            // Simulate refresh with loading state
            const button = event.target.closest('button');
            const icon = button.querySelector('i');
            icon.style.animation = 'spin 1s linear infinite';

            setTimeout(() => {
                icon.style.animation = '';
                // Here you would fetch fresh data from the server
                console.log('Progress refreshed');
            }, 1000);
        }

        // Export data
        function exportData() {
            // Simulate data export
            console.log('Exporting subject progress data...');
            alert('Subject progress data exported successfully!');
        }

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(initializeCharts, 100);

            // Add click handlers for buttons
            document.addEventListener('click', function(e) {
                if (e.target.matches('button') || e.target.closest('button')) {
                    const button = e.target.closest('button') || e.target;

                    // Simple visual feedback
                    button.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        button.style.transform = 'scale(1)';
                    }, 150);
                }
            });

            // Close modal when clicking outside
            document.getElementById('subjectModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeSubjectModal();
                }
            });
        });

        // Add CSS animation for spinning
        const style = document.createElement('style');
        style.textContent = `
            @keyframes spin {
                from { transform: rotate(0deg); }
                to { transform: rotate(360deg); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
